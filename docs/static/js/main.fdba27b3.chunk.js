(this.webpackJsonpwebengine=this.webpackJsonpwebengine||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){"use strict";n.r(t);var i=n(1),r=n.n(i),o=n(6),c=n.n(o),a=(n(13),n(5),n(3)),u=n(2),s=n(7),p=n(0),f=function e(){Object(u.a)(this,e)};f.WorldToCameraCoords=function(e,t){return{x:e.x-t.position.x,y:e.y-t.position.y}},f.CenterCameraOnVector2=function(e,t){return Object(p.a)(Object(p.a)({},t),{},{position:{x:e.x-t.size.width/2,y:e.y-t.size.height/2}})};var l=0,d=function e(){Object(u.a)(this,e)};d.MakeEntity=function(e,t,n,i){return l++,{uuid:String(l),properties:e,components:t,render:n,shaders:i}},d.GetEntityOrigin=function(e){return function(t){var n;if("center"===e.config.origin)n=t.properties.position;else if("topleft"===e.config.origin)n={x:t.properties.position.x-t.properties.scale.x*t.properties.size.width/2,y:t.properties.position.y+t.properties.scale.y*t.properties.size.height/2};else{if("bottomleft"!==e.config.origin)throw new Error("No such origin location option: "+e.config.origin);n={x:t.properties.position.x-t.properties.scale.x*t.properties.size.width/2,y:t.properties.position.y-t.properties.scale.y*t.properties.size.height/2}}return n}},d.GetEntityBBOrigin=function(e){return function(t){var n,i=d.ComputeEntityBoundingBox(e)(t);if("center"===e.config.origin)n={x:(i.minXminY.x+i.maxXmaxY.x)/2,y:(i.minXminY.y+i.maxXmaxY.y)/2};else if("topleft"===e.config.origin)n=i.minXmaxY;else{if("bottomleft"!==e.config.origin)throw new Error("No such origin location: "+e.config.origin);n=i.minXminY}return n}},d.MakeFolderEntity=function(e){return function(t){var n,i=t.map((function(t){return d.ComputeEntityBoundingBox(e)(t)})),o=i.reduce((function(e,t){return t.minXminY.x<e.minXminY.x?t:e}),i[0]).minXminY.x,c=i.reduce((function(e,t){return t.minXminY.y<e.minXminY.y?t:e}),i[0]).minXminY.y,a=i.reduce((function(e,t){return t.maxXmaxY.x>e.maxXmaxY.x?t:e}),i[0]).maxXmaxY.x,u=i.reduce((function(e,t){return t.maxXmaxY.y>e.maxXmaxY.y?t:e}),i[0]).maxXmaxY.y;if("center"===e.config.origin)n={x:(o+a)/2,y:(c+u)/2};else if("topleft"===e.config.origin)n={x:o,y:u};else{if("bottomleft"!==e.config.origin)throw new Error("No such origin location: "+e.config.origin);n={x:o,y:c}}return l++,{uuid:String(l),properties:{position:n,scale:{x:1,y:1},rotation:0,size:{width:a-o,height:u-c}},components:[],shaders:[],render:function(n){var i=t.map((function(e){return Object(p.a)(Object(p.a)({},e),{},{properties:Object(p.a)(Object(p.a)({},e.properties),{},{position:g.Sub(e.properties.position)(n.properties.position)})})})).map((function(t){return Object(p.a)(Object(p.a)({},t),{},{properties:Object(p.a)(Object(p.a)({},t.properties),{},{position:b.RotatePositionAboutPoint(n.properties.rotation)(d.GetEntityOrigin(e)(n))(g.Add(t.properties.position)(n.properties.position)),scale:g.Mul(t.properties.scale)(n.properties.scale),rotation:(t.properties.rotation+n.properties.rotation)%(2*Math.PI)})})})).map((function(e){return e.render(e)}));return r.a.createElement(r.a.Fragment,null,i)}}}},d.ComputeEntityBoundingBox=function(e){return function(t){var n=d.GetEntityOrigin(e)(t),i=[{x:t.properties.position.x-t.properties.size.width*t.properties.scale.x/2,y:t.properties.position.y-t.properties.size.height*t.properties.scale.y/2},{x:t.properties.position.x-t.properties.size.width*t.properties.scale.x/2,y:t.properties.position.y+t.properties.size.height*t.properties.scale.y/2},{x:t.properties.position.x+t.properties.size.width*t.properties.scale.x/2,y:t.properties.position.y-t.properties.size.height*t.properties.scale.y/2},{x:t.properties.position.x+t.properties.size.width*t.properties.scale.x/2,y:t.properties.position.y+t.properties.size.height*t.properties.scale.y/2}].map(b.RotatePositionAboutPoint(t.properties.rotation)(n)),r=i.reduce((function(e,t){return t.x<e.x?t:e}),i[0]).x,o=i.reduce((function(e,t){return t.y<e.y?t:e}),i[0]).y,c=i.reduce((function(e,t){return t.x>e.x?t:e}),i[0]).x,a=i.reduce((function(e,t){return t.y>e.y?t:e}),i[0]).y;return{minXminY:{x:r,y:o},minXmaxY:{x:r,y:a},maxXminY:{x:c,y:o},maxXmaxY:{x:c,y:a}}}};var h=function e(){Object(u.a)(this,e)};h.TickActiveScene=function(e){return function(t){var n=e;if(null===n.activeScene)throw new Error("Cannot tick a null active scene!");var i=n.activeScene;return i.entities=i.entities.map((function(e){var r=e.components.reduce((function(e,n){var r=Object(a.a)(e,2),o=r[0],c=r[1];return n.update(t,o,i,c)}),[e,n]);return n=r[1],r[0]})),n.activeScene=i,n.scenes=n.scenes.map((function(e){return e.uuid===i.uuid?i:e})),n}},h.InitEngine=function(e,t){return{scenes:[],activeScene:null,config:null!==e&&void 0!==e?e:{origin:"center",width:window.innerWidth,height:window.innerHeight},canvas:null!==t&&void 0!==t?t:null}};var y=function e(){Object(u.a)(this,e)};y.CreateRotation=function(e){return function(){return"rotate("+e+"rad)"}},y.CreateScale=function(e){return function(){return"scale("+e.x+","+e.y+")"}},y.CreateTransform=function(e){return e.reduce((function(e,t){return e+" "+t()}),"")},y.ComputeEntityWorldTransformation=function(e){return function(t){var n=d.GetEntityOrigin(e)(t);return{translation:b.RotatePositionAboutPoint(t.properties.rotation)(n)(t.properties.position),scale:t.properties.scale,rotation:t.properties.rotation}}},y.TransformationToStyle=function(e){return function(t,n){return{position:"absolute",width:n.properties.size.width,height:n.properties.size.height,left:e.config.width/2+t.translation.x-t.scale.x*n.properties.size.width/2,bottom:e.config.height/2+t.translation.y-t.scale.y*n.properties.size.height/2,transform:y.CreateTransform([y.CreateScale(t.scale),y.CreateRotation(t.rotation)])}}};var x=function e(){Object(u.a)(this,e)};x.BasicTextureRendererReact=function(e){return function(t){return function(n){var i=y.ComputeEntityWorldTransformation(e)(n),o=y.TransformationToStyle(e)(i,n);return r.a.createElement("img",{src:t.url,alt:t.alt,style:o})}}},x.BoxRendererReact=function(e){return function(t){return function(n){var i=y.ComputeEntityWorldTransformation(e)(n),o=y.TransformationToStyle(e)(i,n);return r.a.createElement("div",{style:Object(p.a)(Object(p.a)({},o),{},{background:w.ColorToString(t)})})}}},x.BasicTextureRenderer=function(e){return function(t){if(null===e.canvas)throw new Error("Cannot render with a canvas renderer without a canvas being linked to the engine state!");return function(n){var i=y.ComputeEntityWorldTransformation(e)(n),o=y.TransformationToStyle(e)(i,n);return r.a.createElement("img",{src:t.url,alt:t.alt,style:o})}}},x.BoxRenderer=function(e){if(null===e.canvas)throw new Error("Cannot render with a canvas renderer without a canvas being linked to the engine state!");return function(t){return function(t){var n;if(null===e.canvas)throw new Error("Cannot render with a canvas renderer without a canvas being linked to the engine state!");var i=y.ComputeEntityWorldTransformation(e)(t),r=Object(p.a)(Object(p.a)({},i),{},{translation:{x:i.translation.x-t.properties.size.width*i.scale.x/2+e.config.width/2,y:e.config.height-(i.translation.y-t.properties.size.height*i.scale.y/2)-e.config.height/2}}),o=null===(n=e.canvas)||void 0===n?void 0:n.getContext("2d");if(!o)throw new Error("Cannot get canvas context!");o.save(),o.fillStyle="red",o.translate(r.translation.x,r.translation.y),o.rotate(r.rotation),o.rect(-t.properties.size.width*r.scale.x/2,-t.properties.size.height*r.scale.y/2,t.properties.size.width*r.scale.x,t.properties.size.height*r.scale.y),o.fill(),o.restore()}}};var m=function e(){Object(u.a)(this,e)};m.CreateScene=function(e){return function(t,n){var i={uuid:String(t),entities:[]};return Object(p.a)(Object(p.a)({},e),{},{scenes:e.scenes.concat(i),activeScene:!0===n?i:e.activeScene})}},m.ActivateScene=function(e){return function(t){var n=e.scenes.find((function(e){return e.uuid===t}));if(void 0===n)throw new Error("Couldn't find a scene with sceneID: "+t);return Object(p.a)(Object(p.a)({},e),{},{activeScene:n})}},m.AddEntityToScene=function(e){return function(t){return function(n){var i,r=e.scenes.find((function(e){return e.uuid===t}));if(void 0===r)throw new Error("No scene could be found with sceneID"+t);var o=e,c=null;if(o.scenes=o.scenes.map((function(e){return e.uuid!==(null===r||void 0===r?void 0:r.uuid)?e:c=Object(p.a)(Object(p.a)({},r),{},{entities:e.entities.concat(n)})})),null===c)throw new Error("No scene could be found with sceneID"+t);return Object(p.a)(Object(p.a)({},o),{},{activeScene:r.uuid===(null===(i=o.activeScene)||void 0===i?void 0:i.uuid)?c:o.activeScene})}}},m.RemoveEntityFromScene=function(e){return function(t){return function(n){var i,r=e.scenes.find((function(e){return e.uuid===t}));if(void 0===r)throw new Error("No scene could be found with sceneID"+t);var o=e,c=null;if(o.scenes=o.scenes.map((function(e){return e.uuid!==(null===r||void 0===r?void 0:r.uuid)?e:c=Object(p.a)(Object(p.a)({},r),{},{entities:e.entities.filter((function(e){return e.uuid!==n.uuid}))})})),null===c)throw new Error("No scene could be found with sceneID"+t);return Object(p.a)(Object(p.a)({},o),{},{activeScene:r.uuid===(null===(i=o.activeScene)||void 0===i?void 0:i.uuid)?c:o.activeScene})}}};var v={Camera:f,Entity:d,Game:h,Renderer:x,Scene:m,StyleConversion:y},g=function e(){Object(u.a)(this,e)};g.Add=function(e){return function(t){return{x:e.x+t.x,y:e.y+t.y}}},g.Sub=function(e){return function(t){return{x:e.x-t.x,y:e.y-t.y}}},g.Mul=function(e){return function(t){return{x:e.x*t.x,y:e.y*t.y}}},g.Div=function(e){return function(t){return{x:e.x/t.x,y:e.y/t.y}}},g.Neg=function(e){return{x:-e.x,y:-e.y}};var w=function e(){Object(u.a)(this,e)};w.ColorToString=function(e){return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"};var b=function e(){Object(u.a)(this,e)};b.RotatePositionAboutPoint=function(e){return function(t){return function(n){var i=Math.cos(e),r=Math.sin(e),o=t.x-n.x,c=t.y-n.y;return{x:i*o+r*c+n.x,y:i*c-r*o+n.y}}}};var O=function e(){Object(u.a)(this,e)};O.OffsetAnimationComponent=function(e){return function(t){return function(n){return function(i){return{update:function(r,o,c,u){if(n){var s=n(r,o,c,u),p=Object(a.a)(s,2);o=p[0],u=p[1]}if(o.properties.position={x:o.properties.position.x+e(o.properties.position.x,o.properties.position.y),y:o.properties.position.y+t(o.properties.position.x,o.properties.position.y)},i){var f=i(r,o,c,u),l=Object(a.a)(f,2);o=l[0],u=l[1]}return[o,u]}}}}}},O.PositionAnimationComponent=function(e){return function(t){return function(n){return function(i){return{update:function(r,o,c,u){if(n){var s=n(r,o,c,u),p=Object(a.a)(s,2);o=p[0],u=p[1]}if(o.properties.position={x:e(o.properties.position.x,o.properties.position.y),y:t(o.properties.position.x,o.properties.position.y)},i){var f=i(r,o,c,u),l=Object(a.a)(f,2);o=l[0],u=l[1]}return[o,u]}}}}}};var E,j=function(e){var t=v.Game.InitEngine(void 0,e);return t=v.Scene.CreateScene(t)("root",!0),E=v.Entity.MakeEntity({position:{x:0,y:0},size:{width:50,height:50},rotation:0,scale:{x:1,y:1}},[{update:function(e,t,n,i){var r=t;return r.properties.rotation=r.properties.position.x/20%(2*Math.PI),r.properties.scale=g.Add(r.properties.scale)({x:.03,y:.03}),[r,i]}},O.PositionAnimationComponent((function(e,t){return e+2.5}))((function(e,t){return Math.pow(e/6,1.5)}))()()],v.Renderer.BoxRenderer(t)({r:255,g:0,b:0,a:1}),[]),t=v.Scene.AddEntityToScene(t)("root")(E)},S=0,C=!1,T=function(e,t){return S+=e,C&&S>6e3&&(console.log("ended!"),R()),C||S>3e3?(C=!0,v.Scene.RemoveEntityFromScene(t)("root")(E)):t},z=-1,X=(new(function(){function e(){Object(u.a)(this,e),this.cbs=new Set}return Object(s.a)(e,[{key:"listen",value:function(e){this.cbs.add(e)}},{key:"message",value:function(e){this.cbs.forEach((function(t){return t(e)}))}},{key:"unlisten",value:function(e){this.cbs.delete(e)}}]),e}()),-1),Y=function(e){var t=Object(a.a)(e,2),n=t[0],i=t[1];!function e(){var t=z;A([n,i]),-1===z&&-1!==t||(z=window.requestAnimationFrame(e))}()},R=function(){-1!==z&&(window.cancelAnimationFrame(z),z=-1),X=-1,0},A=function(e){var t=Object(a.a)(e,2),n=t[0],i=t[1],r=n;if(-1===X){var o=Date.now(),c=v.Game.TickActiveScene(r)(1),u=T(1,c);return i(u),r=u,X=o,1,u}var s=Date.now();if(s-X<1e3/90)return r;var p=s-X,f=v.Game.TickActiveScene(r)(p),l=T(p,f);return i(l),r=l,X=s,1,l},k={height:window.innerHeight,width:window.innerWidth,position:"absolute",top:0,left:0},B=function(){var e=Object(i.useRef)(null);return Object(i.useEffect)((function(){if(null===e.current)throw new Error("Couldn't find canvasRef!");Y([j(e.current),function(e){var t,n,i=null===(t=e.canvas)||void 0===t?void 0:t.getContext("2d");if(!i)throw new Error("Cannot get canvas context!");i.fillStyle="white",i.beginPath(),i.fillRect(0,0,e.config.width,e.config.height),i.stroke(),null===(n=e.activeScene)||void 0===n||n.entities.forEach((function(e){e.render(e)}))}])}),[]),r.a.createElement("canvas",{ref:e,style:k,width:window.innerWidth,height:window.innerHeight})},P=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,15)).then((function(t){var n=t.getCLS,i=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),i(e),r(e),o(e),c(e)}))},I=function(){return r.a.createElement(B,null)};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(I,null)),document.getElementById("root")),P()},5:function(e,t,n){},8:function(e,t,n){e.exports=n(14)}},[[8,1,2]]]);
//# sourceMappingURL=main.fdba27b3.chunk.js.map